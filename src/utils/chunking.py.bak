def chunk_text(text, max_tokens=512):
    """Divide texto em chunks semânticos respeitando parágrafos"""

    paragraphs = text.split('\n\n')
    chunks = []
    current_chunk = ""

    for paragraph in paragraphs:
        
        # Estima tokens (aproximação simples: palavras)
        estimated_tokens = len((current_chunk + paragraph).split())

        if estimated_tokens > max_tokens and current_chunk:
            
            # Salva chunk atual e inicia novo
            chunks.append(current_chunk.strip())
            current_chunk = paragraph

        else:
            # Adiciona parágrafo ao chunk atual
            current_chunk += "\n\n" + paragraph if current_chunk else paragraph
    
    # Adiciona último chunk
    if current_chunk:
        chunks.append(current_chunk.strip())
    
    return chunks